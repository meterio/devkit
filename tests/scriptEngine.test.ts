import { expect } from 'chai';
import { ScriptEngine } from '../src';
const holderAddr = '0x0205c2D862cA051010698b69b54278cbAf945C0b';
const candidateAddr = '0x8a88c59bf15451f9deb1d62f7734fece2002668e';
const candidatePubKey =
  'BKjr6wO34Vif9oJHK1/AbMCLHVpvJui3Nx3hLwuOfzwx1Th4H4G0I4liGEC3qKsf8KOd078gYFTK+41n+KhDTzk=:::uH2sc+WgsrxPs91LBy8pIBEjM5I7wNPtSwRSNa83wo4V9iX3RmUmkEPq1QRv4wwRbosNO1RFJ/r64bwdSKK1VwA=';
const candidateName = 'tester';
const candidateIP = '1.2.3.4';
const candidatePort = 8670;
const bucketID = '0xd75eb6c42a73533f961c38fe2b87bb3615db7ff8e19c0d808c046e7a25d9a413';
const amount = 5e18;
const timestamp = 1567898765;
const nonce = 123456;

describe('script engine', () => {
  it('candidate', () => {
    const scriptData = ScriptEngine.getCandidateData(
      ScriptEngine.ScriptOption.OneWeekLock,
      candidateAddr,
      candidateName,
      candidatePubKey,
      candidateIP,
      candidatePort,
      amount,
      timestamp,
      nonce
    );
    expect(scriptData).equal(
      '0xffffffffdeadbeeff90133c4808203e8b9012bf90128038001948a88c59bf15451f9deb1d62f7734fece2002668e948a88c59bf15451f9deb1d62f7734fece2002668e86746573746572b8b3424b6a7236774f3334566966396f4a484b312f41624d434c485670764a7569334e7833684c77754f667a7778315468344834473049346c6947454333714b7366384b4f64303738675946544b2b34316e2b4b6844547a6b3d3a3a3a75483273632b5767737278507339314c427938704942456a4d354937774e5074537752534e613833776f345639695833526d556d6b4550713151527634777752626f734e4f3152464a2f723634627764534b4b315677413d87312e322e332e348221dea00000000000000000000000000000000000000000000000000000000000000000884563918244f4000001845d743c8d8301e240'
    );
  });

  it('uncandidate', () => {
    const scriptData = ScriptEngine.getUncandidateData(candidateAddr, timestamp, nonce);
    expect(scriptData).equal(
      '0xffffffffdeadbeeff866c4808203e8b85ff85d048080940000000000000000000000000000000000000000948a88c59bf15451f9deb1d62f7734fece2002668e80808080a000000000000000000000000000000000000000000000000000000000000000008001845d743c8d8301e240'
    );
  });

  it('delegate', () => {
    const scriptData = ScriptEngine.getDelegateData(
      holderAddr,
      candidateAddr,
      candidateName,
      candidatePubKey,
      candidateIP,
      candidatePort,
      bucketID,
      amount,
      timestamp,
      nonce
    );
    expect(scriptData).equal(
      '0xffffffffdeadbeeff90133c4808203e8b9012bf90128058080940205c2d862ca051010698b69b54278cbaf945c0b948a88c59bf15451f9deb1d62f7734fece2002668e86746573746572b8b3424b6a7236774f3334566966396f4a484b312f41624d434c485670764a7569334e7833684c77754f667a7778315468344834473049346c6947454333714b7366384b4f64303738675946544b2b34316e2b4b6844547a6b3d3a3a3a75483273632b5767737278507339314c427938704942456a4d354937774e5074537752534e613833776f345639695833526d556d6b4550713151527634777752626f734e4f3152464a2f723634627764534b4b315677413d87312e322e332e348221dea0d75eb6c42a73533f961c38fe2b87bb3615db7ff8e19c0d808c046e7a25d9a413884563918244f4000001845d743c8d8301e240'
    );
  });

  it('undelegate', () => {
    const scriptData = ScriptEngine.getUndelegateData(
      holderAddr,
      bucketID,
      amount,
      timestamp,
      nonce
    );
    expect(scriptData).equal(
      '0xffffffffdeadbeeff86ec4808203e8b867f865068080940205c2d862ca051010698b69b54278cbaf945c0b94000000000000000000000000000000000000000080808080a0d75eb6c42a73533f961c38fe2b87bb3615db7ff8e19c0d808c046e7a25d9a413884563918244f4000001845d743c8d8301e240'
    );
  });

  it('bound', () => {
    const scriptData = ScriptEngine.getBoundData(
      ScriptEngine.ScriptOption.OneWeekLock,
      holderAddr,
      candidateAddr,
      candidateName,
      candidatePubKey,
      candidateIP,
      candidatePort,
      amount,
      timestamp,
      nonce
    );
    expect(scriptData).equal(
      '0xffffffffdeadbeeff90133c4808203e8b9012bf90128018001940205c2d862ca051010698b69b54278cbaf945c0b948a88c59bf15451f9deb1d62f7734fece2002668e86746573746572b8b3424b6a7236774f3334566966396f4a484b312f41624d434c485670764a7569334e7833684c77754f667a7778315468344834473049346c6947454333714b7366384b4f64303738675946544b2b34316e2b4b6844547a6b3d3a3a3a75483273632b5767737278507339314c427938704942456a4d354937774e5074537752534e613833776f345639695833526d556d6b4550713151527634777752626f734e4f3152464a2f723634627764534b4b315677413d87312e322e332e348221dea00000000000000000000000000000000000000000000000000000000000000000884563918244f4000001845d743c8d8301e240'
    );
  });

  it('unbound', () => {
    const scriptData = ScriptEngine.getUnboundData(holderAddr, bucketID, amount, timestamp, nonce);
    expect(scriptData).equal(
      '0xffffffffdeadbeeff86ec4808203e8b867f865028080940205c2d862ca051010698b69b54278cbaf945c0b94000000000000000000000000000000000000000080808080a0d75eb6c42a73533f961c38fe2b87bb3615db7ff8e19c0d808c046e7a25d9a413884563918244f4000001845d743c8d8301e240'
    );
  });

  it('bid', () => {
    const scriptData = ScriptEngine.getBidData(holderAddr, amount, timestamp, nonce);
    expect(scriptData).equal(
      '0xffffffffdeadbeeff859c4808203e9b852f85003808080808080a00000000000000000000000000000000000000000000000000000000000000000940205c2d862ca051010698b69b54278cbaf945c0b884563918244f4000080845d743c8d8301e240'
    );
  });
});
